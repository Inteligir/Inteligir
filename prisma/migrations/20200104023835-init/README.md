# Migration `20200104023835-init`

This migration has been generated by Kaiyu Hsu at 1/4/2020, 2:38:35 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "quaint"."User" (
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "displayName" TEXT    ,
  "email" TEXT NOT NULL DEFAULT ''  ,
  "googleId" TEXT    ,
  "id" TEXT NOT NULL   ,
  "password" TEXT NOT NULL DEFAULT ''  ,
  "resetToken" TEXT    ,
  "resetTokenExpiry" REAL    ,
  "role" TEXT NOT NULL DEFAULT 'USER'  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "quaint"."PlaylistCategory" (
  "description" TEXT    ,
  "id" TEXT NOT NULL   ,
  "name" TEXT NOT NULL DEFAULT ''  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "quaint"."Playlist" (
  "author" TEXT NOT NULL   REFERENCES "User"(id) ON DELETE RESTRICT,
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "description" TEXT    ,
  "emoji" TEXT    ,
  "id" TEXT NOT NULL   ,
  "published" BOOLEAN NOT NULL DEFAULT false  ,
  "thumbnail" TEXT    ,
  "title" TEXT NOT NULL DEFAULT ''  ,
  "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "quaint"."EnrolledPlayList" (
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "enrollee" TEXT NOT NULL   REFERENCES "User"(id) ON DELETE RESTRICT,
  "id" TEXT NOT NULL   ,
  "playlist" TEXT NOT NULL   REFERENCES "Playlist"(id) ON DELETE RESTRICT,
  "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "quaint"."Article" (
  "author" TEXT NOT NULL   REFERENCES "User"(id) ON DELETE RESTRICT,
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "description" TEXT NOT NULL DEFAULT ''  ,
  "id" TEXT NOT NULL   ,
  "link" TEXT    ,
  "playlist" TEXT NOT NULL   REFERENCES "Playlist"(id) ON DELETE RESTRICT,
  "title" TEXT NOT NULL DEFAULT ''  ,
  "type" TEXT NOT NULL DEFAULT 'LINK'  ,
  "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "quaint"."CompletedPlaylist" (
  "completedBy" TEXT NOT NULL   REFERENCES "User"(id) ON DELETE RESTRICT,
  "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  "id" TEXT NOT NULL   ,
  "playlist" TEXT NOT NULL   REFERENCES "Playlist"(id) ON DELETE RESTRICT,
  "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00'  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "quaint"."_PlaylistToPlaylistCategory" (
  "A" TEXT NOT NULL   REFERENCES "Playlist"(id) ON DELETE CASCADE,
  "B" TEXT NOT NULL   REFERENCES "PlaylistCategory"(id) ON DELETE CASCADE
);

CREATE UNIQUE INDEX "quaint"."User.email" ON "User"("email")

CREATE UNIQUE INDEX "quaint"."User.googleId" ON "User"("googleId")

CREATE UNIQUE INDEX "quaint"."_PlaylistToPlaylistCategory_AB_unique" ON "_PlaylistToPlaylistCategory"("A","B")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200104023835-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,82 @@
+datasource db {
+  provider = "sqlite"
+  url      = env("DATABASE_URL")
+  default  = true
+}
+
+generator photon {
+  provider = "photonjs"
+}
+
+enum Role {
+  USER
+  ADMIN
+}
+
+model User {
+  id                String             @default(cuid()) @id
+  email             String             @unique
+  password          String
+  displayName       String?
+  googleId          String?            @unique
+  resetToken        String?
+  resetTokenExpiry  Float?
+  enrolledPlaylists EnrolledPlayList[]
+  role              Role               @default(USER)
+  createdAt         DateTime           @default(now())
+}
+
+model PlaylistCategory {
+  id          String     @default(cuid()) @id
+  name        String
+  description String?
+  playlists   Playlist[]
+}
+
+model Playlist {
+  id          String             @default(cuid()) @id
+  published   Boolean            @default(value: false)
+  title       String
+  description String?
+  author      User
+  emoji       String?
+  thumbnail   String?
+  categories  PlaylistCategory[]
+  articles    Article[]
+  createdAt   DateTime           @default(now())
+  updatedAt   DateTime           @updatedAt
+}
+
+model EnrolledPlayList {
+  id        String   @default(cuid()) @id
+  playlist  Playlist
+  enrollee  User
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+enum ArticleType {
+  LINK
+  VIDEO
+  POST
+}
+
+model Article {
+  id          String      @default(cuid()) @id
+  title       String
+  link        String?
+  description String
+  author      User
+  playlist    Playlist
+  type        ArticleType
+  createdAt   DateTime    @default(now())
+  updatedAt   DateTime    @updatedAt
+}
+
+model CompletedPlaylist {
+  id          String   @default(cuid()) @id
+  completedBy User
+  playlist    Playlist
+  createdAt   DateTime @default(now())
+  updatedAt   DateTime @updatedAt
+}
```


